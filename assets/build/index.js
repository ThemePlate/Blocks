(()=>{"use strict";var e={n:t=>{var l=t&&t.__esModule?()=>t.default:()=>t;return e.d(l,{a:l}),l},d:(t,l)=>{for(var n in l)e.o(l,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:l[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.blocks,l=window.wp.blockEditor,n=window.wp.data,s=window.wp.element,r=window.wp.hooks,o=window.wp.serverSideRender;var i=e.n(o);const a=window.ThemePlate_Blocks||{ajax_url:"",_wpnonce:"",collection:{},locations:[]},c=window.wp.i18n,d=window.wp.components,u=window.ReactJSXRuntime,h=(e,t,n)=>{const[r,o]=(0,s.useState)(!1);switch(e.type){default:case"text":case"time":case"email":case"url":case"date":case"number":return(0,u.jsx)(d.TextControl,{type:e.type,label:e.title,help:e?.help||"",value:t[e.key],onChange:t=>n({[e.key]:t})});case"textarea":return(0,u.jsx)(d.TextareaControl,{label:e.title,help:e?.help||"",value:t[e.key],onChange:t=>n({[e.key]:t})});case"select":case"select2":return(0,u.jsx)(d.SelectControl,{label:e.title,help:e?.help||"",value:t[e.key],options:e.options,multiple:e.multiple,onChange:t=>n({[e.key]:t})});case"radiolist":case"radio":return(0,u.jsx)(d.RadioControl,{label:e.title,help:e?.help||"",selected:t[e.key],options:e.options,onChange:t=>n({[e.key]:t})});case"checklist":case"checkbox":return(0,u.jsxs)(d.BaseControl,{help:e?.help||"",children:[(0,u.jsx)(d.BaseControl.VisualLabel,{children:e.title}),0===e.options.length&&(0,u.jsx)(d.CheckboxControl,{checked:"true"===t[e.key],onChange:t=>n({[e.key]:t.toString()})}),0!==e.options.length&&(0,u.jsx)(s.Fragment,{children:e.options.map((l=>(0,u.jsx)(d.CheckboxControl,{label:l.label,checked:t[e.key].includes(l.value),onChange:s=>{n({[e.key]:e.options.filter((({value:n})=>l.value!==n?t[e.key].includes(n):s)).map((({value:e})=>e))})}},l.value)))})]});case"color":return(0,u.jsxs)(d.BaseControl,{help:e?.help||"",children:[(0,u.jsx)(d.BaseControl.VisualLabel,{children:e.title}),(0,u.jsxs)(s.Fragment,{children:[(0,u.jsxs)(d.Flex,{gap:4,align:"flex-start",justify:"flex-start",children:[(0,u.jsx)(d.FlexItem,{children:(0,u.jsx)(d.Button,{variant:"secondary",onClick:()=>o(!0),children:"Pick"})}),(0,u.jsx)(d.FlexItem,{children:(0,u.jsx)(d.ColorIndicator,{colorValue:t[e.key],className:"themeplate-color-indicator"})})]}),r&&(0,u.jsx)(d.Modal,{focusOnMount:!0,shouldCloseOnEsc:!0,shouldCloseOnClickOutside:!0,title:(0,c.__)("Insert/edit color"),onRequestClose:()=>o(!1),children:(0,u.jsx)(d.ColorPicker,{color:t[e.key],onChange:t=>n({[e.key]:t}),enableAlpha:!0})})]})]});case"range":return(0,u.jsx)(d.RangeControl,{label:e.title,help:e?.help||"",value:parseInt(t[e.key]),onChange:t=>n({[e.key]:t.toString()}),afterIcon:(0,u.jsx)("strong",{children:t[e.key]}),withInputField:!1});case"html":return(0,u.jsx)(s.RawHTML,{children:t[e.key]});case"group":return(0,u.jsxs)(d.BaseControl,{help:e?.help||"",children:[(0,u.jsx)(d.BaseControl.VisualLabel,{children:e.title}),(0,u.jsx)(p,{list:e.fields,attributes:t[e.key],setAttributes:l=>{n({[e.key]:{...t[e.key],...l}})}})]});case"link":return(0,u.jsxs)(d.BaseControl,{help:e?.help||"",children:[(0,u.jsx)(d.BaseControl.VisualLabel,{children:e.title}),(0,u.jsxs)(s.Fragment,{children:[(0,u.jsxs)(d.Flex,{gap:6,align:"center",justify:"flex-start",children:[(0,u.jsx)(d.FlexItem,{children:(0,u.jsx)(d.Button,{variant:"secondary",onClick:()=>o(!0),children:"Select"})}),(0,u.jsx)(d.FlexItem,{children:(0,u.jsx)(d.ExternalLink,{href:t[e.key].url,children:t[e.key].title})})]}),r&&(0,u.jsxs)(d.Modal,{focusOnMount:!0,shouldCloseOnEsc:!0,shouldCloseOnClickOutside:!0,title:(0,c.__)("Insert/edit link"),onRequestClose:()=>o(!1),children:[(0,u.jsx)(d.TextControl,{type:"text",label:(0,c.__)("Link text"),value:t[e.key].text,onChange:l=>n({[e.key]:{...t[e.key],title:l,text:l}})}),(0,u.jsx)(l.__experimentalLinkControl,{value:t[e.key],onChange:t=>n({[e.key]:{...t,text:t.title}})})]})]})]});case"file":const i=(e.multiple?t[e.key]:[t[e.key]]).filter((e=>!!e.id));return(0,u.jsxs)(d.BaseControl,{children:[(0,u.jsx)(d.BaseControl.VisualLabel,{children:e.title}),(0,u.jsx)(l.MediaUpload,{label:e.title,multiple:e.multiple,value:e.multiple?t[e.key].map((({id:e})=>e)):t[e.key].id,onSelect:t=>{const l=Array.isArray(t)?t.map((({id:e,url:t,title:l,type:n,icon:s})=>({id:e.toString(),url:t,title:l,type:n,icon:s}))):{id:t.id.toString(),url:t.url,title:t.title,type:t.type,icon:t.icon};n({[e.key]:l})},render:({open:t})=>(0,u.jsxs)(d.Flex,{gap:4,wrap:!0,children:[(0,u.jsx)(d.FlexItem,{isBlock:!0,children:(0,u.jsx)(d.Button,{variant:"secondary",onClick:t,children:(0,c.__)("Select")})}),i.length>=1&&(0,u.jsx)(d.FlexItem,{isBlock:!1,children:(0,u.jsx)(d.Button,{variant:"secondary",onClick:()=>{n({[e.key]:e.multiple?[]:""})},children:e.multiple&&i.length>1?(0,c.__)("Clear"):(0,c.__)("Remove")})}),(0,u.jsx)(d.Flex,{gap:4,direction:"column",children:i.map((({url:e,title:t,type:l,icon:n},s)=>(0,u.jsx)(d.FlexItem,{isBlock:!0,children:(0,u.jsxs)(d.Card,{children:[(0,u.jsx)(d.CardMedia,{children:(0,u.jsx)("img",{className:"themeplate-image",src:"image"===l?e:n,alt:t})}),(0,u.jsx)(d.CardFooter,{children:t})]})},s)))})]})})]});case"editor":case"type":case"post":case"page":case"user":case"term":return(0,u.jsxs)(d.BaseControl,{help:e?.help||"",children:[(0,u.jsx)(d.BaseControl.VisualLabel,{children:e.title}),(0,u.jsxs)(d.Tip,{children:[(0,u.jsx)("strong",{children:"TODO!"})," Field"," ",(0,u.jsx)("code",{children:e.type})]})]})}};function p(e){const{list:t,attributes:l,setAttributes:n}=e;return(0,u.jsx)(s.Fragment,{children:t.map((e=>(0,u.jsx)(d.PanelRow,{className:["themeplate-blocks-field",`field-${e.class}`],children:h(e,l,n)},e.key)))})}function x(e){const{queried:t,fields:n,attributes:r,setAttributes:o}=e;return t?(0,u.jsx)(s.Fragment,{children:a.locations.map((e=>(0,u.jsx)(s.Fragment,{children:0!==n[e].length&&(0,u.jsx)(l.InspectorControls,{group:e,children:(0,u.jsx)(s.Fragment,{children:"advanced"!==e&&(0,u.jsx)(d.PanelBody,{title:(0,c.__)("Control Fields"),children:(0,u.jsx)(p,{list:n[e],attributes:r,setAttributes:o})})||(0,u.jsxs)(s.Fragment,{children:[(0,u.jsx)(p,{list:n[e],attributes:r,setAttributes:o}),(0,u.jsx)(d.PanelRow,{className:["themeplate-blocks-field","field-type-separator"]})]})})})},e)))}):(0,u.jsx)(l.InspectorControls,{children:(0,u.jsx)(d.Placeholder,{children:(0,u.jsx)(d.Spinner,{})})})}const k="block-editor-server-side-render";function j(e){const t=(0,s.useRef)(),o=(0,s.useRef)(),[c,d]=(0,s.useState)([]),[h,p]=(0,s.useState)(!1),j=(0,l.useBlockProps)({className:"wp-block-themeplate",ref:t}),m=j["data-type"],{attributes:y,setAttributes:b}=e,C=(0,n.useSelect)((t=>t(l.store).getBlock(e.clientId)),[e]),g=a.collection[m],w=g.inner_blocks;return(0,s.useMemo)((()=>{fetch(a.ajax_url,{method:"POST",body:new URLSearchParams({_wpnonce:a._wpnonce,action:"themeplate_blocks_fields",block:m})}).then((e=>e.json())).then((e=>{d(e.data),p(!0)}))}),[m]),(0,s.useEffect)((()=>{const e=new MutationObserver((e=>{if((e=>{if(2!==e.length)return!1;const t=e[1].addedNodes;return 1===t.length&&k===t[0].className})(e)){if(w){const e=t.current.querySelector("ThemePlateInnerBlocks");null===e||e.childNodes.length||e.replaceWith(o.current)}(0,r.doAction)("tpb-rendered",m,t.current,y),(0,r.doAction)(`tpb-rendered-${m.replace(/\//,".")}`,t.current,y)}}));return e.observe(t.current,{childList:!0}),()=>{e.disconnect()}}),[m,w,y]),(0,u.jsxs)(s.Fragment,{children:[(0,u.jsx)(x,{queried:h,fields:c,attributes:y,setAttributes:b}),(0,u.jsxs)("div",{...j,children:[(0,u.jsx)(i(),{block:m,attributes:y,className:k}),w&&(0,u.jsx)(l.InnerBlocks,{ref:o,allowedBlocks:g.allowed_blocks,template:g.template_blocks,templateLock:g.template_lock,renderAppender:C?.innerBlocks?.length?null:l.InnerBlocks.ButtonBlockAppender})]})]})}function m(){return(0,u.jsx)(l.InnerBlocks.Content,{})}Object.keys(a.collection).forEach((e=>{(0,t.registerBlockType)(e,{edit:j,save:m})}))})();